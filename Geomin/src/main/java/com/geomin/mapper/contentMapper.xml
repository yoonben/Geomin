<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.geomin.mapper.contentMapper">
	<!-- //모든 학습 컨텐츠 출력  -->
	<select id="getList" resultType="com.geomin.VO.contentVO">
		select
			p.pkgId, p.pkgName, p.Personnel, p.fixedPrice, p.finalPrice, p.difficulty, p.pkgContent
		from 
			package p
		where 
			elimination = 'N'
	</select>
	
	<!-- //체크박스가 선택된 라인의 데이터 처리 -->
	<insert id="addSubContent" parameterType="java.util.List"> 
		<foreach collection="list" item="list"><!--  separator=";" -->
    		INSERT INTO PKGSUBSDETAIL(pkgId, memberID, PKGNAME, SUBSDATE, PERSONNEL, SUBSPRICE)
    		VALUES (#{list.pkgId}, 'memberID22', #{list.pkgName}, sysdate, #{list.personnel}, #{list.finalPrice})
<!--     		INSERT INTO STUDY_GROUP(GROUPID)
    		VALUES ('NOT GROUP')
    		INSERT INTO PACKAGE(finalPrice)
    		VALUES (#{list.finalPrice}) -->
    	</foreach>
	</insert>
	
	<select id="getSubList" resultType="com.geomin.VO.contentVO">
		SELECT
    		P.pkgId,
    		p.pkgName,
    		m.memberID,
    		d.subsDate,
    		p.finalPrice,
    		p.difficulty,
    		d.PERSONNEL,
    		p.pkgContent,
    		NVL2(g.groupID, g.groupID, 'NOT GROUP') AS groupID
		FROM 
    		package p
		JOIN
    		PKGSUBSDETAIL D
		ON  
    		P.pkgId = D.pkgId
		JOIN
    		member m
		ON 
    		D.memberID = m.memberID
		LEFT JOIN
    		study_group g
		ON
    		D.pkgId = g.pkgId
		WHERE 
    		p.elimination = 'N' AND m.mType = 'T' AND m.memberID = 'memberID22'
	</select>
	
	<!-- <select id="">
	<![CDATA[ 
	SELECT
  TO_CHAR(calendar_day, 'YYYY-MM-DD') AS calendar_day,
  TO_CHAR(calendar_day, 'Day') AS day_name
FROM (
  SELECT
    TRUNC(TO_DATE('2023' || LPAD('8', 2, '0') || '01', 'YYYYMMDD') + (LEVEL - 1)) AS calendar_day
  FROM dual
  CONNECT BY LEVEL <= LAST_DAY(TO_DATE('2023' || LPAD('8', 2, '0') || '01', 'YYYYMMDD')) - TO_DATE('2023' || LPAD('8', 2, '0') || '01', 'YYYYMMDD') + 1
) WHERE calendar_day >= SYSDATE;
 ]]>
</select>	 -->

</mapper>